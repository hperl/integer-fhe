(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     25702,        645]
NotebookOptionsPosition[     24894,        612]
NotebookOutlinePosition[     25253,        628]
CellTagsIndexPosition[     25210,        625]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", "=", 
   SuperscriptBox["2", "16"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KeyGen", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", "4"}], ",", "f", ",", "S", ",", "g", ",", "g2", ",",
         "z", ",", "\[Alpha]", ",", "d", ",", "b", ",", "pk", ",", "sk"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], ":=", 
        RowBox[{
         SuperscriptBox["x", "n"], "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"PrimeQ", "[", "p", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"S", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "#"}], ")"}], "&"}], "/@", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Eta]", "2"]}], ",", 
                FractionBox["\[Eta]", "2"]}], "}"}], ",", "n"}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"S", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "2"}], ",", 
               RowBox[{"-", "4"}], ",", "2", ",", "0"}], "}"}]}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+=", "1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g", "[", "x_", "]"}], ":=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MapIndexed", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", " ", 
                  SuperscriptBox["x", 
                   RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}]]}], "&"}], 
                ",", "S"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"g", "[", "x", "]"}], ",", 
             RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<p: \>\"", ",", "p"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<G: \>\"", ",", 
           RowBox[{"g", "[", "x", "]"}], ",", "\"\< = \>\"", ",", 
           RowBox[{"Factor", "[", 
            RowBox[{
             RowBox[{"g", "[", "x", "]"}], ",", 
             RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<F: \>\"", ",", 
           RowBox[{"f", "[", "x", "]"}], ",", "\"\< = \>\"", ",", 
           RowBox[{"Factor", "[", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",", 
             RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "[", "x_", "]"}], ":=", 
        RowBox[{"PolynomialGCD", "[", 
         RowBox[{
          RowBox[{"g", "[", "x", "]"}], ",", 
          RowBox[{"f", "[", "x", "]"}], ",", 
          RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<D: \>\"", ",", 
           RowBox[{"d", "[", "x", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Root", "[", 
           RowBox[{
            RowBox[{"d", "[", "x", "]"}], ",", "1"}], "]"}], ",", "p"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[Alpha]"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "b"}], "}"}]}], "}"}], "=", 
        RowBox[{"PolynomialExtendedGCD", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "[", "x", "]"}], "/", "p"}], ",", 
          RowBox[{
           RowBox[{"f", "[", "x", "]"}], "/", "p"}], ",", "x"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", " ", 
             RowBox[{"g", "[", "x", "]"}]}], " ", "+", 
            RowBox[{"b", " ", 
             RowBox[{"f", "[", "x", "]"}]}]}], "\[NotEqual]", " ", "p"}], "//",
           "Expand"}], ",", 
         RowBox[{"Throw", "[", 
          RowBox[{
           RowBox[{"z", " ", 
            RowBox[{"g", "[", "x", "]"}]}], " ", "+", 
           RowBox[{"b", " ", 
            RowBox[{"f", "[", "x", "]"}]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"z", ",", "x", ",", "0"}], "]"}], ",", 
          RowBox[{"2", " ", "p"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pk", "=", 
        RowBox[{"{", 
         RowBox[{"p", ",", "\[Alpha]"}], "}"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"sk", "=", 
        RowBox[{"{", 
         RowBox[{"p", ",", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Z: \>\"", ",", "z"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<G: \>\"", ",", 
           RowBox[{"g", "[", "x", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Print", "[", 
          RowBox[{"\"\<b: \>\"", ",", " ", "b"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<---------------------------------------------------\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<PK: \>\"", ",", " ", "pk"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SK: \>\"", ",", " ", "sk"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"g", "[", "\[Alpha]", "]"}], ",", "p"}], "]"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pk", ",", "sk"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Encrypt", "[", 
     RowBox[{"m_", ",", "pk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "\[Alpha]", ",", "r", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "\[Alpha]"}], "}"}], "=", "pk"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"m", "\[NotEqual]", "0"}], "&&", 
          RowBox[{"m", "\[NotEqual]", "1"}]}], ",", 
         RowBox[{"Throw", "[", 
          RowBox[{"\"\<Argument Error: \>\"", ",", " ", "m"}], "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Mu]", "2"]}], ",", 
             FractionBox["\[Mu]", "2"]}], "}"}], ",", "n"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+=", "m"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "[", "x_", "]"}], ":=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", " ", 
               SuperscriptBox["x", 
                RowBox[{
                 RowBox[{"First", "[", "#2", "]"}], "-", "1"}]]}], "&"}], ",",
              "r"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"c", "[", "\[Alpha]", "]"}], ",", "p"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Decrypt", "[", 
     RowBox[{"c_", ",", "sk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "B"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "B"}], "}"}], "=", "sk"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"c", "-", 
          RowBox[{"Round", "[", 
           RowBox[{"c", 
            FractionBox["B", "p"]}], "]"}]}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Add", "[", 
     RowBox[{"c1_", ",", "c2_", ",", "pk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "\[Alpha]"}], "}"}], "=", "pk"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"c1", "+", "c2"}], ",", "p"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mult", "[", 
     RowBox[{"c1_", ",", "c2_", ",", "pk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "\[Alpha]"}], "}"}], "=", "pk"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"c1", " ", "*", "c2"}], ",", "p"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Test", "[", "x_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pk", ",", "sk"}], "}"}], "=", "KeyGen"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Decrypt", "[", 
       RowBox[{
        RowBox[{"Encrypt", "[", 
         RowBox[{"x", ",", "pk"}], "]"}], ",", "sk"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestWithKey", "[", 
    RowBox[{"pk_", ",", "sk_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Decrypt", "[", 
     RowBox[{
      RowBox[{"Encrypt", "[", 
       RowBox[{"x", ",", "pk"}], "]"}], ",", "sk"}], "]"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.477736880882291*^9, 3.4777372242957573`*^9}, {
   3.477737550636429*^9, 3.477737555752627*^9}, {3.477737618009103*^9, 
   3.47773762514986*^9}, {3.477738141717492*^9, 3.4777381956553926`*^9}, {
   3.477738332702284*^9, 3.477738407599428*^9}, {3.477738641121756*^9, 
   3.477738641958028*^9}, {3.4777387421082783`*^9, 3.47773874732323*^9}, {
   3.47773886453446*^9, 3.477738901821496*^9}, {3.4777389429212513`*^9, 
   3.477738959955579*^9}, {3.4777391132642317`*^9, 3.477739290623144*^9}, {
   3.477739396516608*^9, 3.477739470838254*^9}, {3.47773952536689*^9, 
   3.47773957269005*^9}, {3.477739627122409*^9, 3.477739644015315*^9}, {
   3.477739674018564*^9, 3.477739674264288*^9}, {3.4777403970409403`*^9, 
   3.477740432210644*^9}, {3.477740609558*^9, 3.477740618129189*^9}, {
   3.4777407797059917`*^9, 3.477740819405505*^9}, {3.477740857157709*^9, 
   3.4777408572430573`*^9}, {3.477740898765153*^9, 3.477740926121706*^9}, 
   3.477741005527701*^9, 3.477741082970883*^9, {3.4777411390338593`*^9, 
   3.47774115958355*^9}, {3.4777413532758007`*^9, 3.477741401855802*^9}, {
   3.4777414408518133`*^9, 3.477741533570998*^9}, {3.477741572919346*^9, 
   3.477741586296837*^9}, {3.4777418594277*^9, 3.477741874093858*^9}, {
   3.47774192953325*^9, 3.477741944367091*^9}, {3.477742019757028*^9, 
   3.4777421200857*^9}, {3.477742201939052*^9, 3.477742288032065*^9}, {
   3.477742343430893*^9, 3.477742414731903*^9}, {3.477742462009001*^9, 
   3.477742524869349*^9}, {3.477742571723248*^9, 3.477742675391062*^9}, {
   3.477742939601541*^9, 3.477742958065662*^9}, 3.477743050499736*^9, {
   3.4797956523234*^9, 3.4797956531432962`*^9}, {3.479795788191101*^9, 
   3.479795793117963*^9}, {3.479795908809752*^9, 3.4797959499557467`*^9}, {
   3.479796017323489*^9, 3.479796050409513*^9}, {3.479796110818969*^9, 
   3.4797961339784527`*^9}, {3.4797961749397097`*^9, 3.47979620132092*^9}, {
   3.479796255696931*^9, 3.479796284061849*^9}, {3.479796506694315*^9, 
   3.4797965805692883`*^9}, {3.4797990738096647`*^9, 3.479799095782729*^9}, {
   3.479799208654388*^9, 3.4797992267959223`*^9}, {3.4798029926274023`*^9, 
   3.4798030812457952`*^9}, {3.4798032683776627`*^9, 3.479803317493698*^9}, {
   3.479803419100567*^9, 3.479803543283144*^9}, {3.479803587333312*^9, 
   3.479803608660549*^9}, {3.479803640189529*^9, 3.479803791296207*^9}, {
   3.479803829936884*^9, 3.479803930467433*^9}, {3.4798040277427998`*^9, 
   3.479804185906106*^9}, {3.479804294804702*^9, 3.479804381673089*^9}, {
   3.479804436213488*^9, 3.4798044465990953`*^9}, {3.4798046222886543`*^9, 
   3.479804794026181*^9}, {3.479804830092051*^9, 3.479804843197945*^9}, {
   3.479805043954707*^9, 3.479805188452496*^9}, {3.479805231187237*^9, 
   3.479805285681404*^9}, {3.479805451486887*^9, 3.4798056328474283`*^9}, {
   3.479805670039237*^9, 3.479805702889805*^9}, {3.479805980090757*^9, 
   3.4798061402081127`*^9}, {3.4798061878128567`*^9, 
   3.4798061918293333`*^9}, {3.4798062350121307`*^9, 3.479806238332489*^9}, {
   3.4800584458499117`*^9, 3.480058478144003*^9}, {3.480058523177679*^9, 
   3.480058717620088*^9}, {3.480058792053784*^9, 3.480058845495874*^9}, {
   3.480059014180812*^9, 3.480059044288835*^9}, {3.480059074720264*^9, 
   3.480059453497829*^9}, {3.480059684037698*^9, 3.480059916279582*^9}, {
   3.480059967922476*^9, 3.4800599701045103`*^9}, {3.480060001957752*^9, 
   3.480060006538887*^9}, {3.4800601342340937`*^9, 3.480060186166456*^9}, {
   3.480060247718009*^9, 3.480060283713806*^9}, {3.4800603502604094`*^9, 
   3.480060362401361*^9}, {3.480060419535617*^9, 3.4800604385492983`*^9}, {
   3.480060560145133*^9, 3.480060648304553*^9}, {3.48006067841853*^9, 
   3.480060934809649*^9}, {3.48006097343294*^9, 3.480060989502757*^9}, {
   3.4800610763891907`*^9, 3.480061107618125*^9}, {3.480061141820208*^9, 
   3.48006118362324*^9}, {3.480061224942272*^9, 3.480061256524857*^9}, {
   3.480061340664769*^9, 3.480061357496851*^9}, {3.480061518028799*^9, 
   3.480061621360052*^9}, {3.4800617077017937`*^9, 3.48006170823606*^9}, {
   3.4800617382537317`*^9, 3.4800617958637877`*^9}, {3.480062050066544*^9, 
   3.48006226616013*^9}, {3.480062337288143*^9, 3.480062356323016*^9}, {
   3.4800623895703583`*^9, 3.4800623958610373`*^9}, {3.480062438777054*^9, 
   3.4800625636074123`*^9}, {3.4800638939195347`*^9, 
   3.4800639477123623`*^9}, {3.48006400795918*^9, 3.480064012197587*^9}, {
   3.480064070669849*^9, 3.4800640708056097`*^9}, {3.4800641103347692`*^9, 
   3.480064244082621*^9}, {3.480064309702963*^9, 3.4800643589246883`*^9}, {
   3.480064468946575*^9, 3.480064502589489*^9}, {3.4800646243591347`*^9, 
   3.480064630740962*^9}, 3.480064941330367*^9, {3.480064982565353*^9, 
   3.480065007904571*^9}, 3.480065256291676*^9, {3.4800652911220818`*^9, 
   3.480065327496887*^9}, {3.480065425100217*^9, 3.480065613070698*^9}, {
   3.4800656960267887`*^9, 3.4800656974401903`*^9}, {3.480065750292704*^9, 
   3.480065850291257*^9}, {3.480066109613789*^9, 3.4800661103250504`*^9}, {
   3.480066293169929*^9, 3.4800663519382143`*^9}, 3.4806621923866377`*^9, {
   3.480662783836175*^9, 3.480662809632535*^9}, {3.480662839670826*^9, 
   3.480662839862814*^9}, {3.480663044481732*^9, 3.480663149499511*^9}, 
   3.4806639137318773`*^9, {3.4806639464175177`*^9, 3.480664023665802*^9}, {
   3.48066407497997*^9, 3.480664083833913*^9}, {3.480664187474682*^9, 
   3.480664213345009*^9}, {3.480664259081472*^9, 3.480664260453072*^9}, {
   3.480664309190035*^9, 3.4806643522925377`*^9}, {3.480666478776724*^9, 
   3.480666540700614*^9}, {3.480666579277355*^9, 3.480666598036203*^9}, {
   3.480667517549069*^9, 3.480667526675413*^9}, 3.48066758883293*^9, 
   3.480667689653639*^9, {3.4806677589060287`*^9, 3.480667759291565*^9}, {
   3.480667873342555*^9, 3.480667927587887*^9}, 3.480667970791793*^9, {
   3.4806690157587357`*^9, 3.48066901585325*^9}, 3.480669109723928*^9, {
   3.480669163520781*^9, 3.480669174670849*^9}, {3.480669326185753*^9, 
   3.480669351930047*^9}, {3.480669394534809*^9, 3.480669463809623*^9}, {
   3.4806697486616383`*^9, 3.480669748931686*^9}, {3.480669784266374*^9, 
   3.4806697851656723`*^9}, {3.480669873295608*^9, 3.480669900846661*^9}, {
   3.480670167886105*^9, 3.4806701979762287`*^9}, {3.4806705495684423`*^9, 
   3.480670549665732*^9}, {3.4806707044665127`*^9, 3.4806707132829514`*^9}, {
   3.480670753552403*^9, 3.480670754288679*^9}, {3.480670939742145*^9, 
   3.4806709431181793`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pk", ",", "sk"}], "}"}], "=", "KeyGen"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c0", "=", 
   RowBox[{"Encrypt", "[", 
    RowBox[{"0", ",", "pk"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"Encrypt", "[", 
    RowBox[{"1", ",", "pk"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<should be 0: \>\"", ",", 
    RowBox[{"Decrypt", "[", 
     RowBox[{
      RowBox[{"Mult", "[", 
       RowBox[{"c0", ",", "c0", ",", "pk"}], "]"}], ",", "sk"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<should be 1: \>\"", ",", 
    RowBox[{"Decrypt", "[", 
     RowBox[{
      RowBox[{"Mult", "[", 
       RowBox[{"c1", ",", "c1", ",", "pk"}], "]"}], ",", "sk"}], "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.480670927685466*^9, 3.480671130366659*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"should be 0: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["should be 0: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4806711001167307`*^9, 3.480671138248184*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"should be 1: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["should be 1: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4806711001167307`*^9, 3.4806711382501287`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1013909887220038300133267452517740425121", ",", 
     "72892239088885115423657700528707755255"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1013909887220038300133267452517740425121", ",", 
     "7249811308653367345060191888202789"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.480670952173888*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "100"], 
   RowBox[{"Test", "[", "0", "]"}]}], "100"]], "Input",
 CellChangeTimes->{{3.480657787272605*^9, 3.48065784486209*^9}, {
  3.480662217375059*^9, 3.4806622182385178`*^9}, {3.4806676256056767`*^9, 
  3.480667639698699*^9}, {3.480669846379951*^9, 3.4806698464516153`*^9}, {
  3.4806707293013697`*^9, 3.480670729365056*^9}, {3.480670768677596*^9, 
  3.480670785074554*^9}, {3.4806708993351316`*^9, 3.480670899373255*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.480657811440838*^9, 3.4806578479351177`*^9}, {
  3.480662221119186*^9, 3.4806622278849373`*^9}, {3.48066438662843*^9, 
  3.4806643895060883`*^9}, {3.480665617748804*^9, 3.4806656193613377`*^9}, {
  3.4806676047589073`*^9, 3.480667640206402*^9}, {3.480669814155349*^9, 
  3.480669885591744*^9}, {3.480670723130054*^9, 3.4806707868110743`*^9}, {
  3.480670893933607*^9, 3.4806709042070503`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Test", "[", "x", "]"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4800657393680363`*^9, 3.480065745035215*^9}, {
   3.480065865656415*^9, 3.480065880710709*^9}, 3.480065917263479*^9, {
   3.48006608317944*^9, 3.480066094070671*^9}, {3.480066376732231*^9, 
   3.480066409586096*^9}, {3.480066564708487*^9, 3.480066649177285*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 100, $CellContext`x$$ = 0, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`x$$], 0, 1, 1}, {
      Hold[$CellContext`n$$], 1, 100, 1}}, Typeset`size$$ = {
    604., {185., 189.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$655$$ = 
    0, $CellContext`n$656$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 1, $CellContext`x$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$655$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$656$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Table[
         $CellContext`Test[$CellContext`x$$], {$CellContext`n$$}]], 
      "Specifications" :> {{$CellContext`x$$, 0, 1, 1}, {$CellContext`n$$, 1, 
         100, 1}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{647., {257.34375, 262.65625}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.480065881325596*^9, 3.4800659228914623`*^9}, 
   3.480066097475864*^9, {3.480066369421837*^9, 3.480066410316704*^9}, {
   3.480066623443213*^9, 3.480066654175289*^9}, 3.4806573533359137`*^9}]
}, Closed]]
},
WindowToolbars->{},
WindowSize->{800, 1152},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 18690, 436, 1185, "Input"],
Cell[CellGroupData[{
Cell[19260, 460, 982, 30, 88, "Input"],
Cell[CellGroupData[{
Cell[20267, 494, 230, 5, 20, "Print"],
Cell[20500, 501, 232, 5, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20781, 512, 26, 0, 27, "Input"],
Cell[20810, 514, 383, 11, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21230, 530, 528, 10, 53, InheritFromParent],
Cell[21761, 542, 444, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22242, 553, 679, 15, 27, "Input"],
Cell[22924, 570, 1954, 39, 537, "Output"]
}, Closed]]
}
]
*)

(* End of internal cache information *)
